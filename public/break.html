<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>FL6_BREAK_SCENE</title>
	<link rel="stylesheet" href="style-break.css">
</head>
<body>
	<main>
		<div class="left">
			<img src="icons/FL.png" alt="FL6_FALCON_LOGO" class="falcon-logo">
			<div class="tournament-stage">
				&nbsp;
			</div>
			<div class="match">
				<div class="team">
					<span class="inner-box-text" id="team-left-name">&nbsp;</span>
				</div>
				<div class="team-score">
					<span class="inner-box-text" id="team-left-score">&nbsp;</span>
				</div>
				<div class="team-versus">VS</div>
				<div class="team-score">
					<span class="inner-box-text" id="team-right-score">&nbsp;</span>
				</div>
				<div class="team">
					<span class="inner-box-text" id="team-right-name">&nbsp;</span>
				</div>
			</div>
			<div class="maps"></div>
		</div>

		<div class="right">
			<div class="groups">
				<div class="group">
					<div class="group-title">Grupa A</div>
					<table class="group-table" id="group-table-a">
						<thead>
							<tr>
								<th>&nbsp;</th>
								<th>W</th>
								<th>D</th>
								<th>L</th>
								<th>PTS</th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</div>
				<div class="group">
					<div class="group-title">Grupa B</div>
					<table class="group-table" id="group-table-b">
						<thead>
							<tr>
								<th>&nbsp;</th>
								<th>W</th>
								<th>D</th>
								<th>L</th>
								<th>PTS</th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</div>
			</div>
		</div>
	</main>

	<script>
		const ws = new WebSocket('ws://localhost:41079');
		const params = new URLSearchParams(window.location.search);

		// ==================================
		// ZMIENNE KONFIGURACYJNE
		// ==================================
		const tournament_stage = 'Faza Grupowa';

		const map_config = [
			{ map: 'mapname', score_left: 0, score_right: 0 },
			{ map: 'mapname', score_left: 0, score_right: 0 },
			{ map: 'mapname', score_left: 0, score_right: 0 },
		];

		const team_left = {
			name: 'team_left',
			score: 0
		};
		const team_right = {
			name: 'team_right',
			score: 0
		};
		// CZY POKAZAĆ WYNIK MECZU
		const show_scores = true;
		const show_maps = true;

		// RODZAJ ZAWARTOŚCI
		const is_test_broadcast = params.has('test_broadcast');
		const is_tech_pause = params.has('tech_pause');
		const is_stream_end = params.has('stream_end');
		const is_zsttp = params.has('zsttp');
		const is_prod = params.has('prod');

		if (team_left.name.length > 20) document.getElementById('team-left-name').style.fontSize = '24pt';
		if (team_right.name.length > 20) document.getElementById('team-right-name').style.fontSize = '24pt';

		if (is_test_broadcast || is_tech_pause || is_stream_end || is_prod) // cokolwiek co tylko jeden pasek z tekstem jest potrzebny
		{
			document.querySelector('.maps').style.display = 'none';
			document.querySelector('.left').style.width = '100%';
			document.querySelector('.right').style.display = 'none';
			document.querySelector('.tournament-stage').style.display = 'none';
			if (is_zsttp) document.querySelector('.falcon-logo').src = "icons/zst.png";
			document.getElementsByClassName('team')[1].style.display = 'none';
			document.getElementsByClassName('team-score')[0].style.display = 'none';
			document.getElementsByClassName('team-score')[1].style.display = 'none';
			document.querySelector('.team-versus').style.display = 'none';

			if (is_test_broadcast) document.getElementById('team-left-name').innerHTML = 'Transmisja testowa';
			if (is_tech_pause) document.getElementById('team-left-name').innerHTML = 'Przerwa techniczna';
			if (is_stream_end) document.getElementById('team-left-name').innerHTML = 'Dziękujemy za oglądanie!';
			if (is_prod)
			{
				document.querySelector('.falcon-logo').style.display = 'none';
				document.querySelector('.tournament-stage').style.display = 'flex';
				document.querySelector('.tournament-stage').style.fontSize = '28pt';
				document.querySelector('.tournament-stage').innerHTML = 'produkcja';
				document.querySelector('.match').style.marginTop = '0';
				document.getElementById('team-left-name').style.fontSize = '24pt';
				document.getElementById('team-left-name').innerHTML = 'toaster esports entertainment';
			}
		}
		else if (is_zsttp) // tylko na turniej szkolny 
		{
			document.querySelector('.left').style.width = '100%';
			document.querySelector('.right').style.display = 'none';
			document.querySelector('.falcon-logo').src = "icons/zst.png";
			document.querySelector('.tournament-stage').innerHTML = "Wielki finał";
			document.querySelector('#team-left-name').textContent = team_left.name;
			document.querySelector('#team-left-score').textContent = team_left.score;
			document.querySelector('#team-right-name').textContent = team_right.name;
			document.querySelector('#team-right-score').textContent = team_right.score;
		}
		else // jak żadnych parametrów nie będzie
		{
			document.querySelector('.tournament-stage').textContent = tournament_stage;
			document.querySelector('#team-left-name').textContent = team_left.name;
			document.querySelector('#team-left-score').textContent = team_left.score;
			document.querySelector('#team-right-name').textContent = team_right.name;
			document.querySelector('#team-right-score').textContent = team_right.score;
		}

		// to akurat zawsze ma być sprawdzane
		if (show_maps)
		{
			for (let i = 0; i < map_config.length; i++)
			{
				document.querySelector('.maps').innerHTML += `
				<div class="map">
					<div class="map-score">
						<span class="inner-box-text">${map_config[i].score_left}</span>
					</div>
					<div class="map-name">
						<span class="inner-box-text">${map_config[i].map}</span>
					</div>
					<div class="map-score">
						<span class="inner-box-text">${map_config[i].score_right}</span>
					</div>
				</div>
				`;
			}
		}

		const show_timeout = 1800;

		window.addEventListener('DOMContentLoaded', () => {
			setTimeout(() => {
				const show = document.querySelectorAll('.team, .team-score, .team-versus, .tournament-stage, .falcon-logo, .group, .map, .map-score');
				show.forEach(elem => {
					console.log(elem);
					if (show_scores)
					{
						elem.classList.add('show');
					}
					else
					{
						if (!elem.classList.contains('team-score'))
						{
							elem.classList.add('show');
						}
					}

					if (show_maps)
					{
						elem.classList.add('show');
					}
					else
					{
						if (!elem.classList.contains('map'))
						{
							elem.classList.add('show');
						}
					}
				});
			}, show_timeout);

			setTimeout(() => {
				const show = document.querySelectorAll('.inner-box-text');
				show.forEach(elem => {
					console.log(elem);
					elem.classList.add('show');
				});
			}, show_timeout * 1.3);
		});
	</script>
</body>
</html>
